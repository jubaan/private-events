<p id="notice"><%= notice %></p>

<h1>Events</h1>

<div>
  <strong> Hosted by
    <%= link_to @event.host.username, "/users/#{@event.host.id}" %>
  </strong>
  <br>
  <strong>Where?</strong>  <%= @event.location %>
  <br>
  <strong>When?</strong> <%= @event.date %>
  <p>
    <strong>What?</strong>
    <br>
    <%= @event.description %>
  </p>
  <p>
    <strong>Who is coming?</strong>

    <div>
      <strong>Confirmed</strong>
      <% if Event.appointments_by_status(@event.id, true).empty? %>
        <div class="text-muted font-italic">Nobody has confirmed yet!</div>
      <% end %>
      <% Event.appointments_by_status(@event.id, true).each do |appointment| %>
        <div>
          <%= link_to appointment.attendee.username, '/users/#{attendee.id}' %>
        </div>
      <% end %>
    </div>

    <div>
      <strong>Not Confirmed</strong>
      <% if Event.appointments_by_status(@event.id, false).empty? %>
        <div class="text-muted font-italic">Nobody has confirmed yet!</div>
      <% end %>
      <% Event.appointments_by_status(@event.id, false).each do |appointment| %>
        <div>
          <%= link_to appointment.attendee.username, '/users/#{attendee.id}' %>
        </div>
      <% end %>
    </div>

    <br>

    <%# TODO: Get rid of this loop %>
    <strong>Invite friends</strong>
    <br>
    <% @event.invitable_users.each do |attendee| %>
      <%= link_to "Invite #{attendee.username}", appointments_path({:attendee_id => attendee.id, :event_id => @event.id}), :method => 'post' %>
      <br>
    <% end %>

    <br>

    <br>
    <% if @event.host == current_user %>
      <%= link_to 'Edit', edit_event_path(@event) %> |
      <%= link_to 'Destroy', @event, method: :delete, data: { confirm: 'Are you sure?' } %> |
    <% end %>
    <%= link_to 'Back', events_path %>
  </div>
